<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Objective-C对象模型 - BLOG</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="BLOG"><meta name="msapplication-TileImage" content="img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="BLOG"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="在OC中，每一个对象都有一个名为 isa 的指针，指向该对象的类。这个类描述了一系列它的实例相关内容，包括成员变量的列表，成员函数的列表等。每一个对象都可以接受消息，而对象能够接收的消息列表是保存在它所对应的类中。"><meta property="og:type" content="blog"><meta property="og:title" content="Objective-C对象模型"><meta property="og:url" content="http://seabrea.xyz/2017/11/04/Inside_The_OC_Object_Model/"><meta property="og:site_name" content="BLOG"><meta property="og:description" content="在OC中，每一个对象都有一个名为 isa 的指针，指向该对象的类。这个类描述了一系列它的实例相关内容，包括成员变量的列表，成员函数的列表等。每一个对象都可以接受消息，而对象能够接收的消息列表是保存在它所对应的类中。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://s1.ax1x.com/2018/12/14/FUGK2V.jpg"><meta property="og:image" content="https://s1.ax1x.com/2018/12/14/FUGRRP.png"><meta property="og:image" content="https://s1.ax1x.com/2018/12/14/FUGU8x.jpg"><meta property="og:image" content="https://s1.ax1x.com/2018/12/14/FUGLR0.png"><meta property="article:published_time" content="2017-11-04T02:00:00.000Z"><meta property="article:modified_time" content="2022-02-22T08:05:07.360Z"><meta property="article:author" content="Sea Brea"><meta property="article:tag" content="iOS"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://s1.ax1x.com/2018/12/14/FUGK2V.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://seabrea.xyz/2017/11/04/Inside_The_OC_Object_Model/"},"headline":"Objective-C对象模型","image":["https://s1.ax1x.com/2018/12/14/FUGK2V.jpg","https://s1.ax1x.com/2018/12/14/FUGRRP.png","https://s1.ax1x.com/2018/12/14/FUGU8x.jpg","https://s1.ax1x.com/2018/12/14/FUGLR0.png"],"datePublished":"2017-11-04T02:00:00.000Z","dateModified":"2022-02-22T08:05:07.360Z","author":{"@type":"Person","name":"Sea Brea"},"publisher":{"@type":"Organization","name":"BLOG","logo":{"@type":"ImageObject","url":"http://seabrea.xyz/2017/11/04/Inside_The_OC_Object_Model/img/avatar.png"}},"description":"在OC中，每一个对象都有一个名为 isa 的指针，指向该对象的类。这个类描述了一系列它的实例相关内容，包括成员变量的列表，成员函数的列表等。每一个对象都可以接受消息，而对象能够接收的消息列表是保存在它所对应的类中。"}</script><link rel="canonical" href="http://seabrea.xyz/2017/11/04/Inside_The_OC_Object_Model/"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 6.0.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/avatar.png" alt="BLOG" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2017-11-04T02:00:00.000Z" title="2017/11/4 上午10:00:00">2017-11-04</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-02-22T08:05:07.360Z" title="2022/2/22 下午4:05:07">2022-02-22</time></span><span class="level-item"><a class="link-muted" href="/categories/Mobile/">Mobile</a></span><span class="level-item">12 minutes read (About 1787 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Objective-C对象模型</h1><div class="content"><blockquote>
<p>在OC中，每一个对象都有一个名为 isa 的指针，指向该对象的类。这个类描述了一系列它的实例相关内容，包括成员变量的列表，成员函数的列表等。每一个对象都可以接受消息，而对象能够接收的消息列表是保存在它所对应的类中。</p>
</blockquote>
<span id="more"></span>

<h1 id="Objective-C中对象的定义"><a href="#Objective-C中对象的定义" class="headerlink" title="Objective-C中对象的定义"></a>Objective-C中对象的定义</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">typedef struct objc_class *Class;</span><br><span class="line"></span><br><span class="line">/// Represents an instance of a class.</span><br><span class="line">struct objc_object &#123;</span><br><span class="line">    Class _Nonnull isa  OBJC_ISA_AVAILABILITY;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>通过看NSObject.h文件可以知道，基本上包括<code>Class isa</code>指针的都可以被称为对象</p>
<p><img src="https://s1.ax1x.com/2018/12/14/FUGK2V.jpg"></p>
<blockquote>
<p>经典OC对象模型图</p>
</blockquote>
<h2 id="Objective-C中对象的初始化"><a href="#Objective-C中对象的初始化" class="headerlink" title="Objective-C中对象的初始化"></a>Objective-C中对象的初始化</h2><ul>
<li>如何初始化  <blockquote>
<p>Class *obj &#x3D; [[Class alloc] init]<br>alloc申请下一块内存给对象(alloc不只分配在虚拟内存，同时会在物理内存建立映射)<br>init初始化相关的信息</p>
</blockquote>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class *obj = [Class alloc];</span><br><span class="line">obj = [obj init];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (instancetype)init &#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if(self) &#123;</span><br><span class="line">        //此次完成相关自定义的初始化信息</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="OC对象在内存中的结构"><a href="#OC对象在内存中的结构" class="headerlink" title="OC对象在内存中的结构"></a>OC对象在内存中的结构</h2><h3 id="OC对象在内存中的三个部分"><a href="#OC对象在内存中的三个部分" class="headerlink" title="OC对象在内存中的三个部分"></a>OC对象在内存中的三个部分</h3><ol>
<li><p>isa结构体指针</p>
<ul>
<li>类型信息</li>
<li>函数指针</li>
</ul>
</li>
<li><p>父类的部分</p>
<ul>
<li>父类的成员变量</li>
</ul>
</li>
<li><p>自己类的部分</p>
<ul>
<li>自己类的成员变量</li>
</ul>
</li>
</ol>
<blockquote>
<p>C++对象(对比)一样的分为三部分  </p>
</blockquote>
<ol>
<li>虚函数表  </li>
<li>父类部分  </li>
<li>自己的部分</li>
</ol>
<p>ps:  </p>
<ul>
<li>SEL: SEL对象，SEL对象包含方法的编号，放在SEL表中;  </li>
<li>IMP: 保存了方法地址的函数指针，放在IMP表中;  </li>
<li>SEL通过对应关系，在IMP表中找到相应的函数指针.</li>
</ul>
<h3 id="OC对象结构分析"><a href="#OC对象结构分析" class="headerlink" title="OC对象结构分析"></a>OC对象结构分析</h3><p>首先，在OC中大部分事物都是对象，包括类也是一种对象。就像我们可以调用[NSObject alloc]一样，这其实就是向类(对象)发送alloc消息。<br>既然类也是对象，所以类也有自己的<code>isa</code>指针，指向的则是元类(metaclass)。<br>同时，元类也是对象，元类的<code>isa</code>指针则指向的是根元类(root metaclass)。<br>而根元类(root metaclass)的<code>isa</code>指针则指向本身。<br>到此，OC的对象结果完成了一次闭环</p>
<p>实例对象，类，父类，元类 的关系图 : </p>
<p><img src="https://s1.ax1x.com/2018/12/14/FUGRRP.png" alt="关系图"></p>
<p>由图可知，对象的类定义了对象的方法，类的元类定义了类的类方法。每个对象都有自己的类，每个类都有自己的元类。<br>并且，因为类具有继承关系的同时，父类的类方法子类也可以调用，而类方法是在类的元类中定义的。所以实际上 类的元类 和 父类的元类 也是继承关系的。<br>OC中的对象都是继承自NSObject，而NSObject的类方法 alloc 方法则是又NSObject的元类所定义的。但是NSObject的子类都是可以使用类方法 alloc 的，所以NSObject的子类的元类也必然是继承自NSObject的元类的。</p>
<blockquote>
<p>备注：元(meta)的概念来着”元小说”，本质上是讲读者从作者构造好的”盒子”(文章)中脱离出来，在文章中谈论文章本身(比如在文章中谈论这篇文章是怎么写的)。在游戏中类似的作品为《史丹尼的预言》, <code>在现在，&quot;元&quot; 的概念通常表示本质和根源</code></p>
</blockquote>
<h3 id="OC中类的成员变量"><a href="#OC中类的成员变量" class="headerlink" title="OC中类的成员变量"></a>OC中类的成员变量</h3><p>成员变量以图下的方式排列在对象中。</p>
<p>图例:<br><img src="https://s1.ax1x.com/2018/12/14/FUGU8x.jpg"></p>
<p>出于验证，我创建了三个类， grandfather(继承自NSObject) , father(继承自grandfather) , child(继承自father).<br>并分别添加各种的变量。<br>然后实例化child后，打印child：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(chid) $0 = &#123;</span><br><span class="line">  father = &#123;</span><br><span class="line">    grandfather = (_grandfather_mv = 0)</span><br><span class="line">    _father_mv = 0</span><br><span class="line">  &#125;</span><br><span class="line">  _chid_mv = 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中<code>_&lt;类名&gt;_mv</code>是我自定义的变量名。<br>可以发现其结构与图例基本一致。但是没有打印出NSObject层级的isa指针。但是我单独打印NSObject时是有的，可能是xcode做过什么处理吧。</p>
<hr>
<h2 id="Objective-C对象模型的应用"><a href="#Objective-C对象模型的应用" class="headerlink" title="Objective-C对象模型的应用"></a>Objective-C对象模型的应用</h2><h3 id="动态创建类"><a href="#动态创建类" class="headerlink" title="动态创建类"></a>动态创建类</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- (void)start &#123;  </span><br><span class="line"></span><br><span class="line">	//创建一个类</span><br><span class="line">    Class newClass = objc_allocateClassPair([chid class], &quot;newTestClass&quot;, 0);</span><br><span class="line">    //给这个类添加一个方法</span><br><span class="line">    class_addMethod(newClass, @selector(addtestM), (IMP)addm, &quot;v@:&quot;);</span><br><span class="line">    //注册这个类，使其能使用</span><br><span class="line">    objc_registerClassPair(newClass);</span><br><span class="line">    </span><br><span class="line">    id test = [[newClass alloc] init];</span><br><span class="line">    调用这个方法</span><br><span class="line">    [test performSelector:@selector(addtestM)];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>object_getClass和[&lt;对象&gt; class] 的区别，<br>两者在对象都是实例对象的时候是没有区别的，<br>但是在对象是类的时候，object_getClass是获取元类的地址，而[&lt;对象&gt; class]仍然是获取当前的类，<br>根据查找的一些blog提供的内容，object_getClass实际上就是获取的isa指针的内容，但是isa是可被修改的,所以<code>object_getClass获取class是不安全的做法</code></p>
</blockquote>
<p>为了测试之前关于元类的内容，输出一下类和元类的数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">void addm(id self, SEL _cmd) &#123;</span><br><span class="line">    NSLog(@&quot;对象：%@&quot;,self);</span><br><span class="line">    NSLog(@&quot;类:%@(%p) || 父类:%@(%p)&quot;,[self class], [self class], [self superclass], [self superclass]);</span><br><span class="line">    </span><br><span class="line">    Class curClass = [self class];</span><br><span class="line">    for (int i = 1; i &lt; 5; ++i) &#123;</span><br><span class="line">        NSLog(@&quot;当前isa指针指向的是：%p&quot;,curClass);</span><br><span class="line">        curClass =object_getClass(curClass);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    Class objectClass = [NSObject class];</span><br><span class="line">    NSLog(@&quot;NSObject地址：%p&quot;,objectClass);</span><br><span class="line">    NSLog(@&quot;NSObject元类地址：%p&quot;,object_getClass(objectClass));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">test Start!</span><br><span class="line">对象：&lt;newTestClass: 0x100618010&gt;</span><br><span class="line">类:newTestClass(0x100617e20) || 父类:chid(0x100003ca8)</span><br><span class="line">当前isa指针指向的是：0x100617e20</span><br><span class="line">当前isa指针指向的是：0x100617e50</span><br><span class="line">当前isa指针指向的是：0x7fff9f7310f0</span><br><span class="line">当前isa指针指向的是：0x7fff9f7310f0</span><br><span class="line">NSObject地址：0x7fff9f731140</span><br><span class="line">NSObject元类地址：0x7fff9f7310f0</span><br></pre></td></tr></table></figure>

<p>以此，我们可以看出，对象的类的元类，最后都根元类，<br>其isa指针都是指向的NSObject的元类指针。<br>同时NSObject的元类的根元类指向的是它自己</p>
<h3 id="KVO"><a href="#KVO" class="headerlink" title="KVO"></a>KVO</h3><p><code>kvo</code>是一种动态的修改isa的技术。<br>具体参考runtime.</p>
<h3 id="isa-swizzling"><a href="#isa-swizzling" class="headerlink" title="isa swizzling"></a>isa swizzling</h3><p><code>isa swizzling</code>是一种动态的替换类方法和实例方法的功能。</p>
<p>原理上则是修改 IMP和SEL 的关系对应表。<br><img src="https://s1.ax1x.com/2018/12/14/FUGLR0.png"></p>
<p>官方提供了三种实现方式：</p>
<ul>
<li>method_exchangeImplementations(两个方法交换)</li>
<li>class_replaceMethod(会先检查一次新方法是否存在，不存在的话会创建一个方法并交换)</li>
<li>method_setImplementation(为一个SEL设置IMP)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;methodSwizzlingTest.h&quot;</span><br><span class="line">#import &lt;objc/message.h&gt;</span><br><span class="line"></span><br><span class="line">@implementation methodSwizzlingTest</span><br><span class="line"></span><br><span class="line">- (void)start &#123;</span><br><span class="line">    [self sel1];</span><br><span class="line">    [self sel2];</span><br><span class="line">    [self sel3];</span><br><span class="line">    </span><br><span class="line">    [self exchangeMethod];</span><br><span class="line">    </span><br><span class="line">    [self sel1];</span><br><span class="line">    [self sel2];</span><br><span class="line">    [self sel3];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - 原方法</span><br><span class="line"></span><br><span class="line">- (void)sel1 &#123;</span><br><span class="line">    NSLog(@&quot;sel1&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)sel2 &#123;</span><br><span class="line">    NSLog(@&quot;sel2&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)sel3 &#123;</span><br><span class="line">    NSLog(@&quot;sel3&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - 替换方法</span><br><span class="line"></span><br><span class="line">- (void)imp1 &#123;</span><br><span class="line">    NSLog(@&quot;imp1 替换了 sel1&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)imp2 &#123;</span><br><span class="line">    NSLog(@&quot;imp2 替换了 sel2&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)imp3 &#123;</span><br><span class="line">    NSLog(@&quot;imp3 替换了 sel3&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - 交换功能</span><br><span class="line"></span><br><span class="line">- (void)exchangeMethod &#123;</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    Class curclass = [self class];</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        //method_exchangeImplementations</span><br><span class="line">        method_exchangeImplementations(</span><br><span class="line">                                       class_getInstanceMethod(curclass, @selector(sel1)),</span><br><span class="line">                                       class_getInstanceMethod(curclass, @selector(imp1)));</span><br><span class="line">        //class_replaceMethod</span><br><span class="line">        class_replaceMethod(curclass, @selector(sel2), [curclass instanceMethodForSelector:@selector(imp2)], &quot;@:&quot;);</span><br><span class="line">        //method_setImplementation</span><br><span class="line">        method_setImplementation(class_getInstanceMethod(curclass, @selector(sel3)), [curclass instanceMethodForSelector:@selector(imp3)]);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><blockquote>
<p>参考文献：<br>《iOS开发进阶》(唐巧)<br> <a target="_blank" rel="noopener" href="http://blog.csdn.net/qq_32744055/article/details/52387079">isa指针详解</a><br><a target="_blank" rel="noopener" href="http://ios.jobbole.com/81657/">元类是什么</a> </p>
</blockquote>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/iOS/">iOS</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2017/12/06/iOS_Runloop/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">iOS - Runloop</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2017/10/24/Encode/"><span class="level-item">字符编码介绍</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="SeaBrea"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">SeaBrea</p><p class="is-size-6 is-block">记录生活，记录学习</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">42</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">25</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/seabrea" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/seabrea"><i class="fab fa-github"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Backend/"><span class="level-start"><span class="level-item">Backend</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Daily/"><span class="level-start"><span class="level-item">Daily</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Mobile/"><span class="level-start"><span class="level-item">Mobile</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-27T00:00:00.000Z">2021-10-27</time></p><p class="title"><a href="/2021/10/27/ReactRouter/">Router 路由</a></p><p class="categories"><a href="/categories/Web/">Web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-06-27T00:00:00.000Z">2021-06-27</time></p><p class="title"><a href="/2021/06/27/ShellScript/">Shell Script</a></p><p class="categories"><a href="/categories/OS/">OS</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-14T16:00:00.000Z">2020-12-15</time></p><p class="title"><a href="/2020/12/15/FlutterBase/">Flutter基础</a></p><p class="categories"><a href="/categories/Mobile/">Mobile</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-11-23T16:00:00.000Z">2020-11-24</time></p><p class="title"><a href="/2020/11/24/Network/">计算机网络</a></p><p class="categories"><a href="/categories/OS/">OS</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-10-05T13:00:00.000Z">2020-10-05</time></p><p class="title"><a href="/2020/10/05/HowToUseGithub/">如何使用GitHub</a></p><p class="categories"><a href="/categories/Daily/">Daily</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">October 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/01/"><span class="level-start"><span class="level-item">January 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/11/"><span class="level-start"><span class="level-item">November 2018</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/10/"><span class="level-start"><span class="level-item">October 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">September 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/07/"><span class="level-start"><span class="level-item">July 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/03/"><span class="level-start"><span class="level-item">March 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/02/"><span class="level-start"><span class="level-item">February 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C#</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MD5/"><span class="tag">MD5</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Network/"><span class="tag">Network</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/React/"><span class="tag">React</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQL/"><span class="tag">SQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Shell/"><span class="tag">Shell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TypeScript/"><span class="tag">TypeScript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/UI/"><span class="tag">UI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flutter/"><span class="tag">flutter</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go/"><span class="tag">go</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/markdown/"><span class="tag">markdown</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vscode/"><span class="tag">vscode</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/zsh/"><span class="tag">zsh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/"><span class="tag">二进制</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/"><span class="tag">位运算</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/"><span class="tag">字符编码</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="tag">数据结构</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"><span class="tag">正则表达式</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%9F%A5%E8%AF%86%E4%BA%A7%E6%9D%83/"><span class="tag">知识产权</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%8F%E6%B5%8E/"><span class="tag">经济</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%87%AA%E4%B8%BB%E5%AD%A6%E4%B9%A0/"><span class="tag">自主学习</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86/"><span class="tag">计算机原理</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/avatar.png" alt="BLOG" height="28"></a><p class="is-size-7"><span>&copy; 2022 Sea Brea</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>